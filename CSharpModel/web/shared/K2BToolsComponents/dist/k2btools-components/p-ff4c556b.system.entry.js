var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),i=0,t=0;t<n;t++)for(var s=arguments[t],a=0,r=s.length;a<r;a++,i++)o[i]=s[a];return o};System.register(["./p-28f425d7.system.js","./p-5703b7e0.system.js"],(function(e){"use strict";var t,n,o,i;return{setters:[function(e){t=e.r;n=e.c;o=e.h},function(e){i=e.C}],execute:function(){var s=":host{display:block}.K2BTEnhancedCombo{float:left}.K2BTEnhancedComboHeader{border-bottom:1px solid #ccc}.K2BTEnhancedComboHeader:after{content:'â–¼';width:0px}.K2BTEnhancedComboContentsOpen{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:absolute;border:1px solid #ccc;background-color:#fff;z-index:1}.K2BTEnhancedComboSearchInput{width:100%}.K2BTEnhancedComboItems{max-height:300px;overflow:auto;scrollbar-width:thin;scrollbar-color:#d7d7d7 transparent}.K2BTEnhancedComboItems::-webkit-scrollbar{width:6px}.K2BTEnhancedComboItems::-webkit-scrollbar-thumb{background-color:#d7d7d7;border:1px solid transparent;cursor:pointer}.K2BTEnhancedComboContentsClosed{display:none}.K2BTEnhancedComboItem{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;padding:8px}.K2BTEnhancedComboItem:hover{background-color:#ddd;cursor:pointer}.K2BTEnhancedComboItem_TextContainer{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-positive:1;flex-grow:1}.K2BTEnhancedComboSubtitle{font-size:12px}.K2BTEnhancedComboCategoryName{padding-left:5px}.K2BTEnchancedComboCategoryContents .K2BTEnhancedComboItem{padding-left:10px}.K2BTEnhancedComboIcon{width:30px;height:30px;-o-object-fit:cover;object-fit:cover;margin-right:4px}.K2BTEnhancedComboIconInvisible{visibility:hidden}.K2BTEnhancedComboNoItemsFound{width:100%;text-align:center;margin-top:40px;margin-bottom:40px}.K2BTEnhancedComboTrailingText{-ms-flex-positive:0;flex-grow:0}";var a=e("k2bt_enhancedsuggest",function(){function e(e){t(this,e);this.changeEvent=n(this,"change",7);this.newRecordClickedEvent=n(this,"newRecordClicked",7);this.inputValueChangedEvent=n(this,"inputValueChanged",7);this.value=null;this.noresultsfoundtext="No results found";this.enableadditem=true;this.additemcaption="New record";this.enabled=true;this.readonlyclass="";this.searchvalue="";this.placeholder="";this.container=null;this.selectedElement=null}e.prototype.processKeydown=function(e){var t=this;if(e.which==27){this.open=false;e.stopPropagation()}if(e.which==13){this.open=!this.open;this.searchvalue=this.getValueDescription();e.stopPropagation();return false}if(this.open){if(e.which==40){e.stopPropagation();e.preventDefault();var n=i.getAtomicValues_impl(this.getFilteredValues());if(n.length>0){var o=n.findIndex((function(e){return e.value==t.value}));if(o==-1){this.setValueWithoutClosing(n[0].value)}else{o=((o+1)%n.length+n.length)%n.length;this.setValueWithoutClosing(n[o].value)}}}else if(e.which==38){e.stopPropagation();e.preventDefault();var n=i.getAtomicValues_impl(this.getFilteredValues());if(n.length>0){var o=n.findIndex((function(e){return e.value==t.value}));if(o==-1){this.setValueWithoutClosing(n[n.length-1].value)}else{o=((o-1)%n.length+n.length)%n.length;this.setValueWithoutClosing(n[o].value)}}}}};e.prototype.closeMenu=function(e){if(!this.container.contains(e.target))this.open=false};e.prototype.setValue=function(e){this.setValueWithoutClosing(e);this.searchvalue=this.getValueDescription();this.open=false};e.prototype.setValueWithoutClosing=function(e){this.value=e;this.changeEvent.emit(e)};e.prototype.getRawValues=function(){var e;if(this.values==null){e=[]}else if(typeof this.values==="string"){if(this.values=="")e=[];else e=JSON.parse(this.values)}else{e=__spreadArrays(this.values)}return e};e.prototype.getFilteredValues=function(){if(!this.open)return[];var e=this.getRawValues();if(this.searchvalue!="")e=this.getFilteredValues_impl(e);return e};e.prototype.getFilteredValues_impl=function(e){var t=[];if(e!=undefined){for(var n=0,o=e;n<o.length;n++){var i=o[n];if(i.description.toLocaleLowerCase().indexOf(this.searchvalue.toLocaleLowerCase())!=-1){t=t.concat(i)}else{var s=this.getFilteredValues_impl(i.items);if(s.length>0){var a=Object.assign({},i);a.items=s;t=t.concat(a)}}}}return t};e.prototype.onIncludeNewRecordClick=function(){this.open=false;this.newRecordClickedEvent.emit(null)};e.prototype.getAtomicValues=function(){return i.getAtomicValues_impl(this.getRawValues())};e.prototype.getSuggestPopoverContent=function(){var e=this;var t=this.getRawValues();var n=i.containsDetails(t);var s=i.containsIcons(t);var a=i.containsTrailingText(t);var r=this.getFilteredValues();if(r.length>0)return r.map((function(t){return e.getItemContent(t,n,s,a)}));else return o("div",{class:"K2BTEnhancedComboNoItemsFound"},this.noresultsfoundtext)};e.prototype.onImageError=function(e){e.target.classList.add("K2BTEnhancedComboIconInvisible")};e.prototype.getItemContent=function(e,t,n,i){var s=this;var a;if(((a=e.items)===null||a===void 0?void 0:a.length)>0){return o("div",{class:"K2BTEnhancedComboCategory"},o("span",{class:"K2BTEnhancedComboCategoryName"},e.description),o("div",{class:"K2BTEnchancedComboCategoryContents"},e.items.map((function(e){return s.getItemContent(e,t,n,i)}))))}else{return o("div",{class:this.value==e.value?"K2BTEnhancedComboItem K2BTEnhancedComboSelected":"K2BTEnhancedComboItem",ref:function(t){if(s.value==e.value)s.selectedElement=t},onClick:function(){return s.setValue(e.value)}},n?o("div",{class:"K2BTEnhancedComboIconContainer"},o("img",{class:"K2BTEnhancedComboIcon",src:e.imageUrl,onError:function(e){return s.onImageError(e)}})):"",o("div",{class:"K2BTEnhancedComboItem_TextColumn"},o("div",{class:"K2BTEnhancedComboItem_TextContainer"},o("span",{class:"K2BTEnhancedComboDescription"},this.getHighlightedText(e.description)),i?o("span",{class:"K2BTEnhancedComboTrailingText"},this.getHighlightedText(e.trailingText)):""),o("div",{class:"K2BTEnhancedComboItem_TextContainer"},t?o("span",{class:"K2BTEnhancedComboSubtitle"},this.getHighlightedText(e.detail)):"")))}};e.prototype.getHighlightedText=function(e){var t=e.toLowerCase().indexOf(this.searchvalue.toLowerCase());if(this.searchvalue==undefined||this.searchvalue==""||t==-1){return o("span",null,e)}else{return o("span",null,e.substring(0,t),o("span",{class:"K2BTEnhancedComboSearchHighlight"},e.substring(t,t+this.searchvalue.length)),this.getHighlightedText(e.substring(t+this.searchvalue.length)))}};e.prototype.changeSearchValue=function(e){this.searchvalue=e;this.inputValueChangedEvent.emit(null)};e.prototype.getValueDescription=function(){var e=this;var t=this.getAtomicValues();var n=t.find((function(t){return t.value==e.value}));if(n!=undefined){return n.description}return this.value};e.prototype.render=function(){var e=this;this.selectedElement=null;return o("div",null,o("span",{class:this.readonlyclass,style:this.enabled?{display:"none"}:{}},this.getValueDescription()),o("div",{tabindex:"0",class:"K2BTEnhancedCombo",ref:function(t){return e.container=t},style:!this.enabled?{display:"none"}:{}},o("input",{type:"text",class:"form-control Attribute_Trn K2BTEnhancedSuggestInput",value:this.searchvalue,onInput:function(t){return e.changeSearchValue(t.target.value)},placeholder:this.placeholder,onClick:function(){return e.open=true}}),o("div",{class:this.open?"K2BTEnhancedComboContentsOpen":"K2BTEnhancedComboContentsClosed"},o("div",{class:"K2BTEnhancedComboItems"},this.getSuggestPopoverContent()),this.enableadditem?o("span",{class:"K2BTEnhancedComboNewAction",onClick:function(){return e.onIncludeNewRecordClick()}},this.additemcaption):"")))};return e}());a.style=s}}}));